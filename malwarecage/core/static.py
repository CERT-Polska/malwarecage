import os
from flask import Blueprint, safe_join, send_from_directory

from .config import app_config
from .paths import web_bundle_dir

web_folder = app_config.malwarecage.web_folder or web_bundle_dir
static_blueprint = Blueprint("static", __name__)


@static_blueprint.route('/', defaults={'path': ''})
@static_blueprint.route("/<path:path>")
def serve_static(path):
    if path != "" and os.path.exists(safe_join(web_folder, path)):
        return send_from_directory(web_folder, path)
    else:
        return send_from_directory(web_folder, 'index.html')
